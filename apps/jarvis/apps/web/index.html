<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Jarvis - Swarm AI Assistant</title>

    <!-- Favicon -->
    <link rel="icon" href="favicon.ico?v=2" />
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32.png?v=2" />
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16.png?v=2" />
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png?v=2" />

    <!-- PWA -->
    <link rel="manifest" href="site.webmanifest" />
    <meta name="theme-color" content="#0a0a0f" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- SEO / Open Graph -->
    <meta name="description" content="Voice and text AI assistant powered by Swarm" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="Swarm" />
    <meta property="og:title" content="Jarvis - Swarm AI Assistant" />
    <meta property="og:description" content="Voice and text AI assistant powered by Swarm" />
    <meta property="og:image" content="og-image.png" />
    <meta name="twitter:card" content="summary_large_image" />

    <!-- Analytics (Umami) -->
    <script defer src="https://analytics.drose.io/script.js" data-website-id="486eaa80-2916-41ee-a2a2-f55209495028"></script>

    <!-- CSS loaded via main.ts for proper Vite HMR -->
  </head>
  <body>
    <div class="app-container">
      <!-- Mobile Menu Toggle (hidden on desktop) -->
      <button class="sidebar-toggle" id="sidebarToggle" type="button" aria-label="Open conversation sidebar" aria-expanded="false">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 12h18M3 6h18M3 18h18"/>
        </svg>
      </button>

      <!-- Sidebar -->
      <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <h2>Conversations</h2>
        </div>
        <div class="sidebar-content">
          <button id="newConversationBtn" class="sidebar-button primary">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 5v14M5 12h14"/>
            </svg>
            New Conversation
          </button>
          <button id="clearConvosBtn" class="sidebar-button danger">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 6h18M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2m3 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h14zM10 11v6M14 11v6"/>
            </svg>
            Clear All
          </button>
          <div id="conversationList">
            <div class="conversation-item empty">
              <div class="conversation-name">No conversations yet</div>
              <div class="conversation-meta">Start your first conversation</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <div class="main-content">
      <div class="main-header">
        <h1 id="appTitle">Jarvis AI</h1>
        <div class="header-actions">
          <a href="/dashboard" class="header-button" title="Open Dashboard">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="7" height="7"/>
              <rect x="14" y="3" width="7" height="7"/>
              <rect x="14" y="14" width="7" height="7"/>
              <rect x="3" y="14" width="7" height="7"/>
            </svg>
            <span>Dashboard</span>
          </a>
          <button id="syncNowBtn" class="header-button" title="Sync conversations">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M23 4v6h-6M1 20v-6h6M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.64A9 9 0 0 1 3.51 15"/>
            </svg>
            <span>Sync</span>
          </button>
        </div>
      </div>

        <div class="chat-container">
          <div id="transcript">
            <!-- Status messages are set dynamically by the app -->
          </div>
        </div>

        <!-- Voice Controls - Clean design with mode toggle -->
        <div class="voice-controls">
          <!-- Mode Toggle Switch -->
          <div class="mode-toggle-container">
            <span class="mode-label">Push-to-Talk</span>
            <button id="handsFreeToggle" class="mode-toggle" type="button" role="switch" aria-checked="false" aria-label="Toggle hands-free mode">
              <span class="mode-toggle-slider"></span>
            </button>
            <span class="mode-label">Hands-free</span>
          </div>

          <!-- Main Voice Button -->
          <div class="voice-button-wrapper">
            <button id="pttBtn" class="voice-button" type="button" aria-label="Press to talk">
              <div class="voice-button-ring"></div>
              <svg class="voice-icon" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 1a3 3 0 00-3 3v8a3 3 0 006 0V4a3 3 0 00-3-3z"/>
                <path d="M19 10v2a7 7 0 01-14 0v-2M12 19v4M8 23h8"/>
              </svg>
            </button>
            <span class="voice-status-text" aria-live="polite">Tap to talk</span>
          </div>
        </div>

        <!-- Text Input Mode -->
        <div class="text-input-container">
          <input
            type="text"
            id="textInput"
            class="text-input"
            placeholder="Type a command or question..."
            aria-label="Text input"
          />
          <button id="sendTextBtn" class="send-button" aria-label="Send message">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- Task Inbox Sidebar -->
      <aside id="task-inbox-container" class="task-inbox-sidebar">
        <!-- Task Inbox component renders here -->
      </aside>

      <audio id="remoteAudio" autoplay playsinline></audio>
    </div>
    <script type="module" src="main.ts"></script>
  </body>
</html>

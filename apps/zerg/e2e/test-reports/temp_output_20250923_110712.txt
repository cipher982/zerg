[1A[2K[2m[WebServer] [22m[build-only] ğŸ”§ building frontend (debug)â€¦

[1A[2K[2m[WebServer] [22m[build-only] ğŸ—  wasm-pack build (debug) â€¦

[1A[2K[2m[WebServer] [22m[INFO]: ğŸ¯  Checking for the Wasm target...

[1A[2K[2m[WebServer] [22m[INFO]: ğŸŒ€  Compiling to Wasm...

[1A[2K[2m[WebServer] [22m   Compiling unicode-ident v1.0.18

[1A[2K[2m[WebServer] [22m   Compiling proc-macro2 v1.0.94
[2m[WebServer] [22m   Compiling wasm-bindgen-shared v0.2.100
[2m[WebServer] [22m   Compiling log v0.4.26
[2m[WebServer] [22m   Compiling bumpalo v3.17.0
[2m[WebServer] [22m   Compiling rustversion v1.0.20
[2m[WebServer] [22m   Compiling cfg-if v1.0.0
[2m[WebServer] [22m   Compiling wasm-bindgen v0.2.100
[2m[WebServer] [22m   Compiling autocfg v1.4.0
[2m[WebServer] [22m   Compiling once_cell v1.20.3
[2m[WebServer] [22m   Compiling stable_deref_trait v1.2.0
[2m[WebServer] [22m   Compiling litemap v0.8.0
[2m[WebServer] [22m   Compiling writeable v0.6.1
[2m[WebServer] [22m   Compiling memchr v2.7.4
[2m[WebServer] [22m   Compiling zerocopy v0.8.25
[2m[WebServer] [22m   Compiling icu_normalizer_data v2.0.0

[1A[2K[2m[WebServer] [22m   Compiling smallvec v1.15.1

[1A[2K[2m[WebServer] [22m   Compiling serde v1.0.218

[1A[2K[2m[WebServer] [22m   Compiling icu_properties_data v2.0.1

[1A[2K[2m[WebServer] [22m   Compiling regex-syntax v0.8.5

[1A[2K[2m[WebServer] [22m   Compiling parking_lot_core v0.9.11
[2m[WebServer] [22m   Compiling getrandom v0.3.2

[1A[2K[2m[WebServer] [22m   Compiling version_check v0.9.5

[1A[2K[2m[WebServer] [22m   Compiling serde_json v1.0.140

[1A[2K[2m[WebServer] [22m   Compiling aho-corasick v1.1.3

[1A[2K[2m[WebServer] [22m   Compiling utf8_iter v1.0.4

[1A[2K[2m[WebServer] [22m   Compiling num-conv v0.1.0

[1A[2K[2m[WebServer] [22m   Compiling scopeguard v1.2.0

[1A[2K[2m[WebServer] [22m   Compiling ahash v0.8.12

[1A[2K[2m[WebServer] [22m   Compiling time-core v0.1.4

[1A[2K[2m[WebServer] [22m   Compiling num-traits v0.2.19

[1A[2K[2m[WebServer] [22m   Compiling lock_api v0.4.13

[1A[2K[2m[WebServer] [22m   Compiling percent-encoding v2.3.1

[1A[2K[2m[WebServer] [22m   Compiling powerfmt v0.2.0

[1A[2K[2m[WebServer] [22m   Compiling anyhow v1.0.98

[1A[2K[2m[WebServer] [22m   Compiling bit-vec v0.6.3

[1A[2K[2m[WebServer] [22m   Compiling bit-set v0.5.3

[1A[2K[2m[WebServer] [22m   Compiling deranged v0.4.0

[1A[2K[2m[WebServer] [22m   Compiling form_urlencoded v1.2.1

[1A[2K[2m[WebServer] [22m   Compiling time-macros v0.2.22

[1A[2K[2m[WebServer] [22m   Compiling regex-automata v0.4.9

[1A[2K[2m[WebServer] [22m   Compiling quote v1.0.39

[1A[2K[2m[WebServer] [22m   Compiling syn v2.0.99

[1A[2K[2m[WebServer] [22m   Compiling ppv-lite86 v0.2.21

[1A[2K[2m[WebServer] [22m   Compiling nom v8.0.0

[1A[2K[2m[WebServer] [22m   Compiling ryu v1.0.20

[1A[2K[2m[WebServer] [22m   Compiling futures-core v0.3.31

[1A[2K[2m[WebServer] [22m   Compiling lazy_static v1.5.0

[1A[2K[2m[WebServer] [22m   Compiling itoa v1.0.15

[1A[2K[2m[WebServer] [22m   Compiling futures-channel v0.3.31

[1A[2K[2m[WebServer] [22m   Compiling base64 v0.21.7

[1A[2K[2m[WebServer] [22m   Compiling num-cmp v0.1.0

[1A[2K[2m[WebServer] [22m   Compiling bytecount v0.6.9

[1A[2K[2m[WebServer] [22m   Compiling time v0.3.41

[1A[2K[2m[WebServer] [22m   Compiling agent-platform-frontend v0.1.0 (/Users/davidrose/git/zerg/frontend)

[1A[2K[2m[WebServer] [22m   Compiling unicode-segmentation v1.12.0

[1A[2K[2m[WebServer] [22m   Compiling regex v1.11.1

[1A[2K[2m[WebServer] [22m   Compiling num-integer v0.1.46

[1A[2K[2m[WebServer] [22m   Compiling num-complex v0.4.6

[1A[2K[2m[WebServer] [22m   Compiling fancy-regex v0.11.0

[1A[2K[2m[WebServer] [22m   Compiling num-bigint v0.4.6

[1A[2K[2m[WebServer] [22m   Compiling num-iter v0.1.45

[1A[2K[2m[WebServer] [22m   Compiling parking_lot v0.12.4

[1A[2K[2m[WebServer] [22m   Compiling num-rational v0.4.2

[1A[2K[2m[WebServer] [22m   Compiling iso8601 v0.6.3

[1A[2K[2m[WebServer] [22m   Compiling num v0.4.3

[1A[2K[2m[WebServer] [22m   Compiling fraction v0.13.1

[1A[2K[2m[WebServer] [22m   Compiling wasm-bindgen-backend v0.2.100

[1A[2K[2m[WebServer] [22m   Compiling synstructure v0.13.2

[1A[2K[2m[WebServer] [22mwarning: agent-platform-frontend@0.1.0: WebSocket type generation failed: Traceback (most recent call last):

[1A[2K[2m[WebServer] [22m   Compiling zerofrom-derive v0.1.6

[1A[2K[2m[WebServer] [22m   Compiling yoke-derive v0.8.0
[2m[WebServer] [22m   Compiling zerovec-derive v0.11.1
[2m[WebServer] [22m   Compiling displaydoc v0.2.5
[2m[WebServer] [22m   Compiling serde_derive v1.0.218

[1A[2K[2m[WebServer] [22m   Compiling wasm-bindgen-macro-support v0.2.100

[1A[2K[2m[WebServer] [22m   Compiling zerofrom v0.1.6

[1A[2K[2m[WebServer] [22m   Compiling wasm-bindgen-macro v0.2.100

[1A[2K[2m[WebServer] [22m   Compiling yoke v0.8.0

[1A[2K[2m[WebServer] [22m   Compiling zerovec v0.11.2

[1A[2K[2m[WebServer] [22m   Compiling zerotrie v0.2.2

[1A[2K[2m[WebServer] [22m   Compiling js-sys v0.3.77

[1A[2K[2m[WebServer] [22m   Compiling uuid v1.16.0
[2m[WebServer] [22m   Compiling console_error_panic_hook v0.1.7

[1A[2K[2m[WebServer] [22m   Compiling tinystr v0.8.1

[1A[2K[2m[WebServer] [22m   Compiling potential_utf v0.1.2

[1A[2K[2m[WebServer] [22m   Compiling icu_collections v2.0.0

[1A[2K[2m[WebServer] [22m   Compiling icu_locale_core v2.0.0

[1A[2K[2m[WebServer] [22m   Compiling icu_provider v2.0.0

[1A[2K[2m[WebServer] [22m   Compiling icu_properties v2.0.1

[1A[2K[2m[WebServer] [22m   Compiling icu_normalizer v2.0.0

[1A[2K[2m[WebServer] [22m   Compiling idna_adapter v1.2.1

[1A[2K[2m[WebServer] [22m   Compiling idna v1.0.3

[1A[2K[2m[WebServer] [22m   Compiling url v2.5.4

[1A[2K[2m[WebServer] [22m   Compiling getrandom v0.2.15

[1A[2K[2m[WebServer] [22m   Compiling chrono v0.4.40
[2m[WebServer] [22m   Compiling gloo-timers v0.2.6
[2m[WebServer] [22m   Compiling serde-wasm-bindgen v0.5.0
[2m[WebServer] [22m   Compiling web-sys v0.3.77
[2m[WebServer] [22m   Compiling wasm-bindgen-futures v0.4.50

[1A[2K[2m[WebServer] [22m   Compiling rand_core v0.6.4

[1A[2K[2m[WebServer] [22m   Compiling jsonschema v0.17.1

[1A[2K[2m[WebServer] [22m   Compiling rand_chacha v0.3.1

[1A[2K[2m[WebServer] [22m   Compiling rand v0.8.5

[1A[2K[2m[WebServer] [22mwarning: unused import: `crate::toast`
[2m[WebServer] [22m  --> src/components/dashboard/mod.rs:15:5
[2m[WebServer] [22m   |
[2m[WebServer] [22m15 | use crate::toast;
[2m[WebServer] [22m   |     ^^^^^^^^^^^^
[2m[WebServer] [22m   |
[2m[WebServer] [22m   = note: `#[warn(unused_imports)]` on by default
[2m[WebServer] [22m

[1A[2K[2m[WebServer] [22mwarning: unused variable: `doc`
[2m[WebServer] [22m  --> src/components/ops/mod.rs:34:17
[2m[WebServer] [22m   |
[2m[WebServer] [22m34 |             let doc = document.clone();
[2m[WebServer] [22m   |                 ^^^ help: if this is intentional, prefix it with an underscore: `_doc`
[2m[WebServer] [22m   |
[2m[WebServer] [22m   = note: `#[warn(unused_variables)]` on by default
[2m[WebServer] [22m

[1A[2K[2m[WebServer] [22mwarning: unused variable: `root`
[2m[WebServer] [22m   --> src/components/ops/mod.rs:163:9
[2m[WebServer] [22m    |
[2m[WebServer] [22m163 |     let root = match document.get_element_by_id("ops-dashboard") {
[2m[WebServer] [22m    |         ^^^^ help: if this is intentional, prefix it with an underscore: `_root`
[2m[WebServer] [22m

[1A[2K[2m[WebServer] [22mwarning: unused variable: `el`
[2m[WebServer] [22m   --> src/components/ops/mod.rs:822:29
[2m[WebServer] [22m    |
[2m[WebServer] [22m822 |                 if let Some(el) = document.get_element_by_id("header") {
[2m[WebServer] [22m    |                             ^^ help: if this is intentional, prefix it with an underscore: `_el`
[2m[WebServer] [22m

[1A[2K[2m[WebServer] [22mwarning: unused variable: `document`
[2m[WebServer] [22m   --> src/ui/setup.rs:184:34
[2m[WebServer] [22m    |
[2m[WebServer] [22m184 | fn restore_persisted_shelf_state(document: &Document) -> bool {
[2m[WebServer] [22m    |                                  ^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_document`
[2m[WebServer] [22m

[1A[2K[2m[WebServer] [22mwarning: variable does not need to be mutable
[2m[WebServer] [22m   --> src/update.rs:813:17
[2m[WebServer] [22m    |
[2m[WebServer] [22m813 |             for mut node in nodes {
[2m[WebServer] [22m    |                 ----^^^^
[2m[WebServer] [22m    |                 |
[2m[WebServer] [22m    |                 help: remove this `mut`
[2m[WebServer] [22m    |
[2m[WebServer] [22m    = note: `#[warn(unused_mut)]` on by default
[2m[WebServer] [22m

[1A[2K[2m[WebServer] [22mwarning: `agent-platform-frontend` (lib) generated 6 warnings (run `cargo fix --lib -p agent-platform-frontend` to apply 2 suggestions)
[2m[WebServer] [22m    Finished `dev` profile [unoptimized + debuginfo] target(s) in 16.73s

[1A[2K[2m[WebServer] [22m[INFO]: â¬‡ï¸  Installing wasm-bindgen...

[1A[2K[2m[WebServer] [22m[INFO]: Optional fields missing from Cargo.toml: 'description', 'repository', and 'license'. These are not necessary, but recommended

[1A[2K[2m[WebServer] [22m[INFO]: âœ¨   Done in 17.11s
[2m[WebServer] [22m[INFO]: ğŸ“¦   Your wasm pkg is ready to publish at /Users/davidrose/git/zerg/frontend/pkg.

[1A[2K[2m[WebServer] [22m[build-only] ğŸ“¦ copying WASM artifacts to www...

[1A[2K[2m[WebServer] [22m[build-only] âœï¸  writing bootstrap.js â€¦

[1A[2K[2m[WebServer] [22m[build-only] ğŸ§© generating index.html from template â€¦

[1A[2K[2m[WebServer] [22m[build-only] âœï¸  writing config.js â€¦

[1A[2K[2m[WebServer] [22m[build-only] âœ… build complete (output in frontend/www/)

ğŸš€ Setting up test environment...
âœ… Pre-test cleanup completed
âœ… Test environment setup completed

Running 6 tests using 2 workers

[1A[2K[1/6] [chromium] â€º tests/canvas_api_contract.spec.ts:10:7 â€º Canvas UI Tests â€º Canvas tab loads successfully without errors
[1A[2K[2/6] [chromium] â€º tests/agent_creation_full.spec.ts:15:7 â€º Agent Creation Full Workflow â€º Complete agent creation and isolation test
[1A[2K[chromium] â€º tests/agent_creation_full.spec.ts:15:7 â€º Agent Creation Full Workflow â€º Complete agent creation and isolation test
ğŸ” Starting complete agent creation test...

[1A[2KğŸ“Š Worker ID: 0

[1A[2KğŸ“Š Step 0: Resetting database...

[1A[2KDatabase reset attempt 1: HTTP 422

[1A[2K[2m[WebServer] [22mERROR - Database session rolled back due to error: (1001, None)

[1A[2K[3/6] [chromium] â€º tests/canvas_api_contract.spec.ts:36:7 â€º Canvas UI Tests â€º Canvas persists state when switching tabs
[1A[2KDatabase reset attempt 2: HTTP 422

[1A[2K[2m[WebServer] [22mERROR - Database session rolled back due to error: (1001, None)

[1A[2K[4/6] [chromium] â€º tests/canvas_api_contract.spec.ts:58:7 â€º Canvas UI Tests â€º Canvas workspace is interactive
[1A[2KDatabase reset attempt 3: HTTP 422

[1A[2Kâš ï¸  Database reset failed: Error: Failed to reset database via request after 3 attempts
    at resetDatabaseViaRequest [90m(/Users/davidrose/git/zerg/e2e/[39mtests/helpers/database-helpers.ts:111:9[90m)[39m
    at [90m/Users/davidrose/git/zerg/e2e/[39mtests/agent_creation_full.spec.ts:25:7
    at [90m/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/worker/workerMain.js:304:9
    at [90m/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/worker/testInfo.js:277:11
    at TimeoutManager.withRunnable [90m(/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/worker/timeoutManager.js:67:14[90m)[39m
    at TestInfoImpl._runWithTimeout [90m(/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/worker/testInfo.js:275:7[90m)[39m
    at [90m/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/worker/workerMain.js:302:7
    at WorkerMain._runTest [90m(/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/worker/workerMain.js:277:5[90m)[39m
    at WorkerMain.runTestGroup [90m(/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/worker/workerMain.js:193:11[90m)[39m
    at process.<anonymous> [90m(/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/common/process.js:70:22[90m)[39m

[1A[2KğŸ“Š Step 1: Verifying empty state...

[1A[2K[2m[WebServer] [22mERROR - Database session rolled back due to error: (1001, None)

[1A[2K[5/6] [chromium] â€º tests/canvas_complete_workflow.spec.ts:17:7 â€º Complete Canvas Workflow â€º End-to-end canvas workflow with agent and tool execution
[1A[2K[chromium] â€º tests/canvas_complete_workflow.spec.ts:17:7 â€º Complete Canvas Workflow â€º End-to-end canvas workflow with agent and tool execution
ğŸš€ Starting complete canvas workflow test...

[1A[2KğŸ“Š Worker ID: 1

[1A[2KğŸ“Š Step 1: Creating test agent...

[1A[2Kâœ… Test agent created with ID: [33m1[39m

[1A[2KğŸ“Š Step 2: Navigating to application...

[1A[2K[chromium] â€º tests/agent_creation_full.spec.ts:15:7 â€º Agent Creation Full Workflow â€º Complete agent creation and isolation test
ğŸ“Š Initial agent count: [33m0[39m

[1A[2KğŸ“Š Step 2: Creating agent via API...

[1A[2KğŸ“Š Agent creation status: [33m201[39m

[1A[2KğŸ“Š Created agent ID: [33m1[39m

[1A[2KğŸ“Š Created agent name: Test Agent Worker 0

[1A[2KğŸ“Š Step 3: Verifying agent appears in list...

[1A[2KğŸ“Š Updated agent count: [33m1[39m

[1A[2Kâœ… Agent found in list with correct data

[1A[2KğŸ“Š Step 5: Testing UI integration...

[1A[2K[chromium] â€º tests/canvas_complete_workflow.spec.ts:17:7 â€º Complete Canvas Workflow â€º End-to-end canvas workflow with agent and tool execution
ğŸ“Š Step 3: Verifying agent in dashboard...

[1A[2KğŸ“Š Agent visible in dashboard: [33mtrue[39m

[1A[2KğŸ“Š Step 4: Navigating to canvas...

[1A[2K[chromium] â€º tests/agent_creation_full.spec.ts:15:7 â€º Agent Creation Full Workflow â€º Complete agent creation and isolation test
ğŸ“Š Agent visible in UI: [33mtrue[39m

[1A[2Kâœ… Agent successfully appears in UI

[1A[2KğŸ“Š Step 6: Creating second agent for isolation test...

[1A[2KğŸ“Š Second agent created with ID: [33m2[39m

[1A[2KğŸ“Š Step 7: Verifying agent isolation...

[1A[2KğŸ“Š Final agent count: [33m2[39m

[1A[2KğŸ“Š Worker-specific agent count: [33m2[39m

[1A[2Kâœ… Complete agent creation and isolation test passed!

[1A[2K[2m[WebServer] [22mERROR - Database session rolled back due to error: (1001, None)

[1A[2K[6/6] [chromium] â€º tests/comprehensive_debug.spec.ts:15:7 â€º Comprehensive Debug â€º Complete system debug and diagnosis
[1A[2K[chromium] â€º tests/comprehensive_debug.spec.ts:15:7 â€º Comprehensive Debug â€º Complete system debug and diagnosis
ğŸ” Starting comprehensive debug test...

[1A[2KğŸ“Š Worker ID: 0

[1A[2KğŸ“Š NODE_ENV: test

[1A[2KğŸ“Š Backend URL: http://127.0.0.1:47300

[1A[2KğŸ” Test 1: Basic connectivity

[1A[2Kâœ… Backend is accessible

[1A[2KğŸ” Test 2: Header transmission

[1A[2Kâœ… Headers can be sent

[1A[2KğŸ” Test 3: Agent GET endpoint

[1A[2KğŸ“Š Agent GET count: [33m2[39m

[1A[2Kâœ… Agent GET endpoint working

[1A[2KğŸ” Test 4: Testing different database operations

[1A[2KğŸ“Š Testing user endpoint...

[1A[2KğŸ“Š User data available: [33mtrue[39m

[1A[2KğŸ” Test 5: Workflow creation test

[1A[2KğŸ“Š Workflow created ID: [33m1[39m

[1A[2Kâœ… Workflow creation working

[1A[2KğŸ” Test 6: Minimal agent creation

[1A[2KğŸ“Š Minimal agent created ID: [33m3[39m

[1A[2Kâœ… Agent creation working with mock model

[1A[2KğŸ” Test 7: System health

[1A[2KğŸ“Š System health: {"status":"ok","db":{"status":"ok"},"ws":{"available":true,"active_connections":1,"topics":4}}

[1A[2Kâœ… Comprehensive debug test complete

[1A[2K[chromium] â€º tests/canvas_complete_workflow.spec.ts:17:7 â€º Complete Canvas Workflow â€º End-to-end canvas workflow with agent and tool execution
ğŸ“Š Canvas visible: [33mtrue[39m

[1A[2Kâœ… Canvas loaded successfully

[1A[2KğŸ“Š Step 5: Checking agent shelf...

[1A[2KğŸ“Š Agent shelf visible: [33mtrue[39m

[1A[2KğŸ“Š Agent visible in shelf: [33mtrue[39m

[1A[2Kâœ… Agent found in shelf - ready for drag and drop

[1A[2KğŸ“Š Step 7: Checking tool palette...

[1A[2KğŸ“Š Tool palette visible: [33mtrue[39m

[1A[2KğŸ“Š HTTP tool visible: [33mtrue[39m

[1A[2KğŸ“Š URL tool visible: [33mfalse[39m

[1A[2Kâœ… Tools found in palette - ready for workflow creation

[1A[2KğŸ“Š Step 8: Attempting drag and drop workflow...

[1A[2KğŸ“Š Agent drag operation attempted

[1A[2KğŸ“Š Agent node on canvas: [33mfalse[39m

[1A[2Kâœ… Complete canvas workflow test finished

[1A[2KğŸ“Š Summary: Basic navigation and UI structure validated

[1A[2KğŸ“Š Next: UI implementation needed for full drag-and-drop workflow

[1A[2K[2m[WebServer] [22mERROR - Database session rolled back due to error: (1001, None)

ğŸ§¹ Starting test environment cleanup...
âœ… Test database cleanup completed
âœ… Test environment cleanup completed
[1A[2K  6 passed (32.2s)

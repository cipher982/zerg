ğŸš€ Setting up test environment...
âœ… Pre-test cleanup completed
âœ… Test environment setup completed

Running 6 tests using 2 workers

[1A[2K[1/6] [chromium] â€º tests/agent_creation_full.spec.ts:15:7 â€º Agent Creation Full Workflow â€º Complete agent creation and isolation test
[1A[2K[2/6] [chromium] â€º tests/canvas_api_contract.spec.ts:10:7 â€º Canvas UI Tests â€º Canvas tab loads successfully without errors
[1A[2K[chromium] â€º tests/agent_creation_full.spec.ts:15:7 â€º Agent Creation Full Workflow â€º Complete agent creation and isolation test
ğŸ” Starting complete agent creation test...

[1A[2KğŸ“Š Worker ID: 0

[1A[2KğŸ“Š Step 0: Resetting database...

[1A[2KDatabase reset attempt 1: HTTP 422

[1A[2K[3/6] [chromium] â€º tests/canvas_api_contract.spec.ts:36:7 â€º Canvas UI Tests â€º Canvas persists state when switching tabs
[1A[2K[4/6] [chromium] â€º tests/canvas_api_contract.spec.ts:58:7 â€º Canvas UI Tests â€º Canvas workspace is interactive
[1A[2KDatabase reset attempt 2: HTTP 422

[1A[2K[5/6] [chromium] â€º tests/canvas_complete_workflow.spec.ts:17:7 â€º Complete Canvas Workflow â€º End-to-end canvas workflow with agent and tool execution
[1A[2K[chromium] â€º tests/canvas_complete_workflow.spec.ts:17:7 â€º Complete Canvas Workflow â€º End-to-end canvas workflow with agent and tool execution
ğŸš€ Starting complete canvas workflow test...

[1A[2KğŸ“Š Worker ID: 1

[1A[2KğŸ“Š Step 1: Creating test agent...

[1A[2Kâœ… Test agent created with ID: [33m1[39m

[1A[2KğŸ“Š Step 2: Navigating to application...

[1A[2K[chromium] â€º tests/agent_creation_full.spec.ts:15:7 â€º Agent Creation Full Workflow â€º Complete agent creation and isolation test
Database reset attempt 3: HTTP 422

[1A[2Kâš ï¸  Database reset failed: Error: Failed to reset database via request after 3 attempts
    at resetDatabaseViaRequest [90m(/Users/davidrose/git/zerg/e2e/[39mtests/helpers/database-helpers.ts:111:9[90m)[39m
    at [90m/Users/davidrose/git/zerg/e2e/[39mtests/agent_creation_full.spec.ts:25:7
    at [90m/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/worker/workerMain.js:304:9
    at [90m/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/worker/testInfo.js:277:11
    at TimeoutManager.withRunnable [90m(/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/worker/timeoutManager.js:67:14[90m)[39m
    at TestInfoImpl._runWithTimeout [90m(/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/worker/testInfo.js:275:7[90m)[39m
    at [90m/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/worker/workerMain.js:302:7
    at WorkerMain._runTest [90m(/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/worker/workerMain.js:277:5[90m)[39m
    at WorkerMain.runTestGroup [90m(/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/worker/workerMain.js:193:11[90m)[39m
    at process.<anonymous> [90m(/Users/davidrose/git/zerg/e2e/[39mnode_modules/[4mplaywright[24m/lib/common/process.js:70:22[90m)[39m

[1A[2KğŸ“Š Step 1: Verifying empty state...

[1A[2KğŸ“Š Initial agent count: [33m0[39m

[1A[2KğŸ“Š Step 2: Creating agent via API...

[1A[2KğŸ“Š Agent creation status: [33m201[39m

[1A[2KğŸ“Š Created agent ID: [33m1[39m

[1A[2KğŸ“Š Created agent name: Test Agent Worker 0

[1A[2KğŸ“Š Step 3: Verifying agent appears in list...

[1A[2KğŸ“Š Updated agent count: [33m1[39m

[1A[2Kâœ… Agent found in list with correct data

[1A[2KğŸ“Š Step 5: Testing UI integration...

[1A[2K[chromium] â€º tests/canvas_complete_workflow.spec.ts:17:7 â€º Complete Canvas Workflow â€º End-to-end canvas workflow with agent and tool execution
ğŸ“Š Step 3: Verifying agent in dashboard...

[1A[2KğŸ“Š Agent visible in dashboard: [33mfalse[39m

[1A[2K[6/6] [chromium] â€º tests/canvas_complete_workflow.spec.ts:17:7 â€º Complete Canvas Workflow â€º End-to-end canvas workflow with agent and tool execution (retry #1)
[1A[2KğŸš€ Starting complete canvas workflow test...

[1A[2KğŸ“Š Worker ID: 2

[1A[2KğŸ“Š Step 1: Creating test agent...

[1A[2Kâœ… Test agent created with ID: [33m1[39m

[1A[2KğŸ“Š Step 2: Navigating to application...

[1A[2K[chromium] â€º tests/agent_creation_full.spec.ts:15:7 â€º Agent Creation Full Workflow â€º Complete agent creation and isolation test
ğŸ“Š Agent visible in UI: [33mfalse[39m

[1A[2Kâš ï¸  Agent not visible in UI (this might be expected based on UI implementation)

[1A[2KğŸ“Š Step 6: Creating second agent for isolation test...

[1A[2KğŸ“Š Second agent created with ID: [33m2[39m

[1A[2KğŸ“Š Step 7: Verifying agent isolation...

[1A[2KğŸ“Š Final agent count: [33m2[39m

[1A[2KğŸ“Š Worker-specific agent count: [33m2[39m

[1A[2Kâœ… Complete agent creation and isolation test passed!

[1A[2K[7/6] (retries) [chromium] â€º tests/comprehensive_debug.spec.ts:15:7 â€º Comprehensive Debug â€º Complete system debug and diagnosis
[1A[2K[chromium] â€º tests/comprehensive_debug.spec.ts:15:7 â€º Comprehensive Debug â€º Complete system debug and diagnosis
ğŸ” Starting comprehensive debug test...

[1A[2KğŸ“Š Worker ID: 0

[1A[2KğŸ“Š NODE_ENV: test

[1A[2KğŸ“Š Backend URL: http://127.0.0.1:47300

[1A[2KğŸ” Test 1: Basic connectivity

[1A[2Kâœ… Backend is accessible

[1A[2KğŸ” Test 2: Header transmission

[1A[2Kâœ… Headers can be sent

[1A[2KğŸ” Test 3: Agent GET endpoint

[1A[2KğŸ“Š Agent GET count: [33m2[39m

[1A[2Kâœ… Agent GET endpoint working

[1A[2KğŸ” Test 4: Testing different database operations

[1A[2KğŸ“Š Testing user endpoint...

[1A[2KğŸ“Š User data available: [33mtrue[39m

[1A[2KğŸ” Test 5: Workflow creation test

[1A[2KğŸ“Š Workflow created ID: [33m1[39m

[1A[2Kâœ… Workflow creation working

[1A[2KğŸ” Test 6: Minimal agent creation

[1A[2KğŸ“Š Minimal agent created ID: [33m3[39m

[1A[2Kâœ… Agent creation working with mock model

[1A[2KğŸ” Test 7: System health

[1A[2KğŸ“Š System health: {"status":"ok","db":{"status":"ok"},"ws":{"available":true,"active_connections":0,"topics":0}}

[1A[2Kâœ… Comprehensive debug test complete

[1A[2K[chromium] â€º tests/canvas_complete_workflow.spec.ts:17:7 â€º Complete Canvas Workflow â€º End-to-end canvas workflow with agent and tool execution
ğŸ“Š Step 3: Verifying agent in dashboard...

[1A[2KğŸ“Š Agent visible in dashboard: [33mfalse[39m

[1A[2K  1) [chromium] â€º tests/canvas_complete_workflow.spec.ts:17:7 â€º Complete Canvas Workflow â€º End-to-end canvas workflow with agent and tool execution 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBe[2m([22m[32mexpected[39m[2m) // Object.is equality[22m

    Expected: [32mtrue[39m
    Received: [31mfalse[39m

      51 |     const agentInDashboard = await page.locator(`text=${createdAgent.name}`).isVisible();
      52 |     console.log('ğŸ“Š Agent visible in dashboard:', agentInDashboard);
    > 53 |     expect(agentInDashboard).toBe(true);
         |                              ^
      54 |     
      55 |     // Step 4: Navigate to canvas
      56 |     console.log('ğŸ“Š Step 4: Navigating to canvas...');
        at /Users/davidrose/git/zerg/e2e/tests/canvas_complete_workflow.spec.ts:53:30

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/canvas_complete_workflow-C-c6777-th-agent-and-tool-execution-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/canvas_complete_workflow-C-c6777-th-agent-and-tool-execution-chromium/error-context.md

    attachment #3: trace (application/zip) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/canvas_complete_workflow-C-c6777-th-agent-and-tool-execution-chromium/trace.zip
    Usage:

        npx playwright show-trace test-results/canvas_complete_workflow-C-c6777-th-agent-and-tool-execution-chromium/trace.zip

    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Retry #1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBe[2m([22m[32mexpected[39m[2m) // Object.is equality[22m

    Expected: [32mtrue[39m
    Received: [31mfalse[39m

      51 |     const agentInDashboard = await page.locator(`text=${createdAgent.name}`).isVisible();
      52 |     console.log('ğŸ“Š Agent visible in dashboard:', agentInDashboard);
    > 53 |     expect(agentInDashboard).toBe(true);
         |                              ^
      54 |     
      55 |     // Step 4: Navigate to canvas
      56 |     console.log('ğŸ“Š Step 4: Navigating to canvas...');
        at /Users/davidrose/git/zerg/e2e/tests/canvas_complete_workflow.spec.ts:53:30

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/canvas_complete_workflow-C-c6777-th-agent-and-tool-execution-chromium-retry1/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/canvas_complete_workflow-C-c6777-th-agent-and-tool-execution-chromium-retry1/error-context.md

    attachment #3: trace (application/zip) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/canvas_complete_workflow-C-c6777-th-agent-and-tool-execution-chromium-retry1/trace.zip
    Usage:

        npx playwright show-trace test-results/canvas_complete_workflow-C-c6777-th-agent-and-tool-execution-chromium-retry1/trace.zip

    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€


ğŸ§¹ Starting test environment cleanup...
âœ… Test database cleanup completed
âœ… Test environment cleanup completed
[1A[2K  1 failed
    [chromium] â€º tests/canvas_complete_workflow.spec.ts:17:7 â€º Complete Canvas Workflow â€º End-to-end canvas workflow with agent and tool execution 
  5 passed (11.6s)

{
  "consumer": {
    "name": "agent-frontend"
  },
  "interactions": [
    {
      "description": "subscribe_thread → receive thread_history",
      "request": {
        "body": {
          "message_id": "test-1",
          "thread_id": 1,
          "type": "subscribe_thread"
        },
        "subtype": "text",
        "type": "websocket"
      },
      "response": {
        "body": {
          "messages": [],
          "thread_id": 1,
          "type": "thread_history"
        }
      }
    },
    {
      "description": "subscribe to workflow_execution → receive execution_finished",
      "request": {
        "body": {
          "message_id": "test-workflow-1",
          "topics": [
            "workflow_execution:123"
          ],
          "type": "subscribe"
        },
        "subtype": "text",
        "type": "websocket"
      },
      "response": {
        "body": {
          "data": {
            "duration_ms": 1500,
            "error": null,
            "execution_id": 123,
            "status": "success"
          },
          "req_id": "test-workflow-1",
          "topic": "workflow_execution:123",
          "ts": 1234567890,
          "type": "execution_finished",
          "v": 1
        }
      }
    },
    {
      "description": "subscribe to agent → receive agent_event status running",
      "request": {
        "body": {
          "message_id": "test-agent-1",
          "topics": [
            "agent:123"
          ],
          "type": "subscribe"
        },
        "subtype": "text",
        "type": "websocket"
      },
      "response": {
        "body": {
          "data": {
            "id": 123,
            "status": "running"
          },
          "topic": "agent:123",
          "ts": 1234567890,
          "type": "agent_event",
          "v": 2
        }
      }
    },
    {
      "description": "subscribe to agent → receive agent_event status idle",
      "request": {
        "body": {
          "message_id": "test-agent-2",
          "topics": [
            "agent:123"
          ],
          "type": "subscribe"
        },
        "subtype": "text",
        "type": "websocket"
      },
      "response": {
        "body": {
          "data": {
            "id": 123,
            "status": "idle",
            "last_run_at": "2024-01-01T12:00:02.000Z",
            "thread_id": 456,
            "last_error": null
          },
          "topic": "agent:123",
          "ts": 1234567890,
          "type": "agent_event",
          "v": 2
        }
      }
    },
    {
      "description": "subscribe to agent → receive run_update created",
      "request": {
        "body": {
          "message_id": "test-run-1",
          "topics": [
            "agent:123"
          ],
          "type": "subscribe"
        },
        "subtype": "text",
        "type": "websocket"
      },
      "response": {
        "body": {
          "data": {
            "event_type": "run_created",
            "agent_id": 123,
            "run_id": 789,
            "status": "queued"
          },
          "topic": "agent:123",
          "ts": 1234567890,
          "type": "run_update",
          "v": 2
        }
      }
    },
    {
      "description": "subscribe to agent → receive run_update success",
      "request": {
        "body": {
          "message_id": "test-run-2",
          "topics": [
            "agent:123"
          ],
          "type": "subscribe"
        },
        "subtype": "text",
        "type": "websocket"
      },
      "response": {
        "body": {
          "data": {
            "event_type": "run_updated",
            "agent_id": 123,
            "run_id": 789,
            "status": "success",
            "finished_at": "2024-01-01T12:00:02.000Z",
            "duration_ms": 1800
          },
          "topic": "agent:123",
          "ts": 1234567890,
          "type": "run_update",
          "v": 2
        }
      }
    },
    {
      "description": "subscribe to thread → receive thread_message",
      "request": {
        "body": {
          "message_id": "test-thread-1",
          "topics": [
            "thread:456"
          ],
          "type": "subscribe"
        },
        "subtype": "text",
        "type": "websocket"
      },
      "response": {
        "body": {
          "data": {
            "thread_id": 456,
            "message": {
              "id": 1001,
              "role": "assistant",
              "content": "I'll help you with that task...",
              "timestamp": "2024-01-01T12:00:01.800Z",
              "processed": true,
              "tool_calls": null
            }
          },
          "topic": "thread:456",
          "ts": 1234567890,
          "type": "thread_message",
          "v": 2
        }
      }
    },
    {
      "description": "subscribe to thread → receive stream_start",
      "request": {
        "body": {
          "message_id": "test-stream-1",
          "topics": [
            "thread:456"
          ],
          "type": "subscribe"
        },
        "subtype": "text",
        "type": "websocket"
      },
      "response": {
        "body": {
          "data": {
            "thread_id": 456,
            "message_id": 1001
          },
          "topic": "thread:456",
          "ts": 1234567890,
          "type": "stream_start",
          "v": 2
        }
      }
    },
    {
      "description": "subscribe to thread → receive stream_chunk",
      "request": {
        "body": {
          "message_id": "test-stream-2",
          "topics": [
            "thread:456"
          ],
          "type": "subscribe"
        },
        "subtype": "text",
        "type": "websocket"
      },
      "response": {
        "body": {
          "data": {
            "thread_id": 456,
            "message_id": 1001,
            "chunk": "Hello",
            "chunk_type": "assistant_token"
          },
          "topic": "thread:456",
          "ts": 1234567890,
          "type": "stream_chunk",
          "v": 2
        }
      }
    },
    {
      "description": "subscribe to thread → receive stream_end",
      "request": {
        "body": {
          "message_id": "test-stream-3",
          "topics": [
            "thread:456"
          ],
          "type": "subscribe"
        },
        "subtype": "text",
        "type": "websocket"
      },
      "response": {
        "body": {
          "data": {
            "thread_id": 456,
            "message_id": 1001
          },
          "topic": "thread:456",
          "ts": 1234567890,
          "type": "stream_end",
          "v": 2
        }
      }
    },
    {
      "description": "heartbeat → receive PING",
      "request": {
        "body": {
          "message_id": "test-ping-1",
          "topics": [
            "system"
          ],
          "type": "subscribe"
        },
        "subtype": "text",
        "type": "websocket"
      },
      "response": {
        "body": {
          "type": "PING",
          "v": 2,
          "topic": "system",
          "ts": 1234567890,
          "data": {}
        }
      }
    },
    {
      "description": "subscribe to workflow_execution → receive node_state",
      "request": {
        "body": {
          "message_id": "test-node-1",
          "topics": [
            "workflow_execution:123"
          ],
          "type": "subscribe"
        },
        "subtype": "text",
        "type": "websocket"
      },
      "response": {
        "body": {
          "data": {
            "execution_id": 123,
            "node_id": "node_1",
            "status": "running",
            "output": null,
            "error": null
          },
          "topic": "workflow_execution:123",
          "ts": 1234567890,
          "type": "node_state",
          "v": 1
        }
      }
    }
  ],
  "metadata": {
    "pactSpecification": {
      "version": "4.0"
    }
  },
  "provider": {
    "name": "zerg-backend"
  }
}